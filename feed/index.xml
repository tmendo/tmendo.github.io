<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Secure Batatas</title>
	<atom:link href="/feed/?simply_static_page=63" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>Batatas is my foobar. Security.</description>
	<lastBuildDate>Mon, 19 Oct 2015 17:17:07 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=</generator>
	<item>
		<title>Testing uploads with Burp Intruder &#8211; Updated</title>
		<link>/testing-uploads-with-burp-intruder-updated/</link>
					<comments>/testing-uploads-with-burp-intruder-updated/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Tue, 01 Sep 2015 10:28:27 +0000</pubDate>
				<category><![CDATA[burp]]></category>
		<category><![CDATA[extension]]></category>
		<category><![CDATA[web security]]></category>
		<category><![CDATA[file]]></category>
		<category><![CDATA[payload]]></category>
		<category><![CDATA[upload]]></category>
		<guid isPermaLink="false">/?p=268</guid>

					<description><![CDATA[Just updated my Intruder extension (described here) to provide two payload generators: the original one with the file contents and another one with the matching file name. So, if you need both the content and file name in your Intruder attack, choose Pitchfork as the Attack type and use File as Payload for one Payload [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Just updated my Intruder extension (described <a href="/?p=250">here</a>) to provide two payload generators: the original one with the file contents and another one with the matching file name.</p>
<p>So, if you need both the content and file name in your Intruder attack, choose Pitchfork as the Attack type and use File as Payload for one Payload set and Filename as Payload for the other.</p>
<p>With this update you can synchronize the file name and its contents in the attack without much hassle, something that was not trivial in the previous version. </p>
]]></content:encoded>
					
					<wfw:commentRss>/testing-uploads-with-burp-intruder-updated/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Testing uploads with Burp Intruder</title>
		<link>/testing-uploads-with-burp-intruder/</link>
					<comments>/testing-uploads-with-burp-intruder/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Sat, 22 Aug 2015 01:29:56 +0000</pubDate>
				<category><![CDATA[burp]]></category>
		<category><![CDATA[extension]]></category>
		<category><![CDATA[web security]]></category>
		<category><![CDATA[bapp store]]></category>
		<category><![CDATA[file]]></category>
		<category><![CDATA[intruder]]></category>
		<category><![CDATA[payload]]></category>
		<category><![CDATA[upload]]></category>
		<guid isPermaLink="false">/?p=250</guid>

					<description><![CDATA[While testing an file upload functionality with Burp&#8217;s Repeater I noticed the site response changed depending on the file being uploaded, which is normal if the server is validating the file headers. After a few requests with different responses I got tired of doing this manually and decided to use Burp&#8217;s Intruder feature. I quickly [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>While testing an file upload functionality with Burp&#8217;s Repeater I noticed the site response changed depending on the file being uploaded, which is normal if the server is validating the file headers.<br />
After a few requests with different responses I got tired of doing this manually and decided to use Burp&#8217;s Intruder feature. I quickly noticed that there is no way of telling the Intruder to inject the contents of a list of files in the request.</p>
<p>So I wrote an extension that reads a folder files and feeds their content, one at a time, as a payload to use in the Intruder.<br />
Suppose you have a folder with your best malicious files, zip and xml bombs, jpegs with other contents, php shells, etc. You point the extension to this folder and just use the Repeater normally, setting the payload source as being this extension.<br />
If you need/want to synchronize the file contents with the file name, the extension tab shows the names of the files it just read so you can use them as payload for a second position in the request, using the pitchfork attack.  </p>
<blockquote><p><code><strong>EDIT</strong></code><br />
There is a new version of the extension that provides two generators, one for the file name and other for the file contents, easing this synchronization process. See <a href="/?p=268">this</a> update post.
</p></blockquote>
<div id="attachment_258" style="width: 1065px" class="wp-caption alignnone"><a href="/wp-content/uploads/2015/08/BurpIntruderFilePayload.png"><img aria-describedby="caption-attachment-258" decoding="async" src="/wp-content/uploads/2015/08/BurpIntruderFilePayload.png" alt="Burp Intruder File Payload Extension tab" width="1055" height="449" class="size-full wp-image-258" /></a><p id="caption-attachment-258" class="wp-caption-text">Choosing the input files</p></div>
<div id="attachment_262" style="width: 562px" class="wp-caption alignnone"><a href="/wp-content/uploads/2015/08/BurpIntruderFilePayload2.png"><img aria-describedby="caption-attachment-262" decoding="async" loading="lazy" src="/wp-content/uploads/2015/08/BurpIntruderFilePayload2.png" alt="Configuring the Intruder" width="552" height="339" class="size-full wp-image-262" /></a><p id="caption-attachment-262" class="wp-caption-text">Configuring the Intruder</p></div>
<p>The extension is available <a href="https://github.com/tmendo/BurpIntruderFilePayloadGenerator/raw/master/dist/IntruderFilePayloadGenerator.jar">here</a> as a single jar. The code is available <a href="https://github.com/tmendo/BurpIntruderFilePayloadGenerator" target="_blank">here</a>.<br />
I have submitted it to the BApp Store but it hasn&#8217;t been approved yet.</p>
<blockquote><p><code><strong>EDIT</strong></code><br />
Now available at the BApp Store, <a href="https://portswigger.net/bappstore/ShowBappDetails.aspx?uuid=880cf2cf689b4067afd9db8e2aefb8ba" target="_blank">here</a> :)
</p></blockquote>
<p>Enjoy.</p>
]]></content:encoded>
					
					<wfw:commentRss>/testing-uploads-with-burp-intruder/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>OCSP stapling</title>
		<link>/ocsp-stapling/</link>
					<comments>/ocsp-stapling/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Fri, 08 May 2015 22:35:32 +0000</pubDate>
				<category><![CDATA[operations]]></category>
		<category><![CDATA[web security]]></category>
		<category><![CDATA[nginx]]></category>
		<category><![CDATA[ocsp]]></category>
		<category><![CDATA[ssl]]></category>
		<category><![CDATA[stapling]]></category>
		<category><![CDATA[tls]]></category>
		<guid isPermaLink="false">/?p=190</guid>

					<description><![CDATA[Tired of seeing wrong OCSP stapling configurations, even those made by me, I&#8217;m writing this so I won&#8217;t forget how to do it right..and hopefully aid others. This is also an excuse to read more about the subject :) OCSP stapling is good: you have one less connection to a server that has nothing to [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Tired of seeing wrong OCSP stapling configurations, even those made by me, I&#8217;m writing this so I won&#8217;t forget how to do it right..and hopefully aid others. This is also an excuse to read more about the subject :)</p>
<p>OCSP stapling is good: you have one less connection to a server that has nothing to do with the intended purpose of the original connection and still get an OCSP response. Sure, you have a few more bytes on every connection but it is harder for the attacker to interrupt the OCSP process without interfering with the target server itself.</p>
<p>For nginx, you need to use a configuration at least with these directives:<br />
<code><br />
ssl_stapling on;<br />
ssl_stapling_verify on;<br />
ssl_trusted_certificate /etc/nginx/certs/bundle_with_root_stapling.pem;<br />
</code></p>
<p><strong>ssl_stapling on;</strong> enables stapling. To be honest, you can make stapling work only with this line.</p>
<p><strong>ssl_stapling_verify on;</strong> this forces our server to check if the OCSP response is valid, meaning properly signed by the respective CA. </p>
<p><strong>ssl_trusted_certificate /etc/nginx/certs/bundle_with_root_stapling.pem;</strong> path to the chain that validates the responses. If you enabled ssl_stapling_verify you need this directive. It must have all the intermediates CAs, including the root. Just concatenate every CA in the chain, PEM encoded, with the root in the end.</p>
<p>Then just issue <code>sudo service nginx restart</code> and test it. You can test it with <code>echo | openssl s_client -connect mendo.pt:443 -status</code></p>
<p>You will likely get something like<br />
<code>OCSP response: no response sent</code></p>
<p>This happens because nginx will not prefetch a valid response until it gets a connection, so the first connection won&#8217;t receive an OCSP response. Try again after a few seconds and you will get<br />
<code><br />
OCSP response:<br />
======================================<br />
OCSP Response Data:<br />
    OCSP Response Status: successful (0x0)<br />
    Response Type: Basic OCSP Response<br />
    Version: 1 (0x0)<br />
    Responder Id: C = IL, O = StartCom Ltd. (Start Commercial Limited), CN = StartCom Class 1 Server OCSP Signer<br />
    Produced At: May  8 20:48:21 2015 GMT<br />
    Responses:<br />
    Certificate ID:<br />
      Hash Algorithm: sha1<br />
      Issuer Name Hash: 6568874F40750F016A3475625E1F5C93E5A26D58<br />
      Issuer Key Hash: EB4234D098B0AB9FF41B6B08F7CC642EEF0E2C45<br />
      Serial Number: 05A143427C3754<br />
    Cert Status: good<br />
    This Update: May  8 20:48:21 2015 GMT<br />
    Next Update: May 10 20:48:21 2015 GMT</p>
<p>    Signature Algorithm: sha1WithRSAEncryption<br />
         98:47:f1:39:4b:ef:f6:67:3d:46:d4:3c:93:fc:ab:95:20:a3:<br />
         e8:d0:2b:64:63:d8:46:d7:65:3f:00:5d:50:9c:7d:b7:2c:4c:<br />
         36:b1:58:86:9f:4b:95:d4:a4:fa:0f:bb:50:3b:a3:e8:d2:a6:<br />
         f3:5f:8c:c3:62:b1:75:90:8a:ab:50:cd:33:6a:cc:6c:ea:04:<br />
         a5:65:ff:09:15:41:0c:76:98:7a:79:93:f4:e1:8b:a5:a1:0c:<br />
         1e:90:04:25:05:98:91:2c:cc:62:0a:2b:06:a3:28:46:55:90:<br />
         f3:0f:09:3c:57:51:98:ed:9c:6f:03:f6:01:9e:d5:61:1b:cf:<br />
         f2:7a:0b:f2:9d:e1:52:ba:4a:34:ba:5c:95:7b:40:de:83:96:<br />
         55:d0:df:41:e7:14:58:28:9b:6a:67:67:fc:db:59:ab:8a:35:<br />
         90:a9:75:8b:9e:8b:46:51:0c:e9:8c:4e:43:60:34:f7:86:06:<br />
         09:0b:5f:03:16:b7:ab:15:49:ea:15:c4:f7:c6:d0:ec:22:01:<br />
         fd:8a:f1:d0:b9:f5:12:14:b7:13:5b:13:80:a6:60:be:11:bc:<br />
         28:c8:86:44:4b:1f:dd:fc:1e:5a:2e:a0:21:52:8d:c7:6c:e5:<br />
         72:c0:11:f4:15:16:54:96:14:f7:5f:5a:3f:cf:46:10:60:f5:<br />
         46:15:0a:8b<br />
</code></p>
<p>Simple.</p>
<blockquote><p><code><strong>EDIT</strong></code><br />
Because nginx will only resolve the OCSP hostname at startup and its IP can change, you might consider setting the following directive (pick you DNS resolver):</p>
<p><strong>resolver 8.8.8.8;</strong>
</p></blockquote>
]]></content:encoded>
					
					<wfw:commentRss>/ocsp-stapling/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Monitoring Pastebin</title>
		<link>/monitoring-pastebin/</link>
					<comments>/monitoring-pastebin/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Mon, 30 Mar 2015 09:34:28 +0000</pubDate>
				<category><![CDATA[monitoring]]></category>
		<category><![CDATA[delegate]]></category>
		<category><![CDATA[password]]></category>
		<category><![CDATA[password dump]]></category>
		<category><![CDATA[pastebin]]></category>
		<category><![CDATA[pastes]]></category>
		<category><![CDATA[tor]]></category>
		<guid isPermaLink="false">/?p=140</guid>

					<description><![CDATA[Suppose you want to monitor the Internet for certain keywords such as your username, email or some text pattern relevant for you or your company. A good starting point is to monitor Pastebin for those keywords, since that is where most of the interesting stuff gets dumped. What I wanted was simple: detect new pastes [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Suppose you want to monitor the Internet for certain keywords such as your username, email or some text pattern relevant for you or your company. A good starting point is to monitor <a href="http://pastebin.com/" title="Pastebin" target="_blank">Pastebin</a> for those keywords, since that is where most of the interesting stuff gets dumped.</p>
<p>What I wanted was simple:</p>
<ul>
<li>detect new pastes that match a given pattern</li>
<li>save matching pastes</li>
<li>do some processing on those pastes</li>
<li>notify me with the results</li>
</ul>
<p>You can register alarms on Pastebin for up to 3 keywords and get notified upon matching, but you cannot use regular expressions or exclude keywords. Also, mail notifications are not the easiest to handle automatically.</p>
<p>The classical choice was to use <a href="https://github.com/xme/pastemon" title="Pastemon" target="_blank">Pastemon</a>, maybe the first software of its kind. I had two problems with it: it would not save pastes to file and it was no longer maintained.<br />
Searching for alternatives I found <a href="https://github.com/cvandeplas/pystemon" title="Pystemon" target="_blank">Pystemon</a>, a newer and improved version of Pastemon.</p>
<p>So I ended up building the following setup:</p>
<p>1. setup Pystemon to download and store any pastes that match my rules.</p>
<ol>
<li>get (my version of) Pystemon <code>git clone https://github.com/tmendo/pystemon.git</code></li>
<li>edit pystemon.yaml</li>
<li style="margin-left:60px;">set the archive dir</li>
<li style="margin-left:60px;">enable and configure email alerts</li>
<li style="margin-left:60px;">enable the use proxy option</li>
<li style="margin-left:60px;">define some search patterns, for instance</li>
<p><code></p>
<pre>
 - search: '[^a-zA-Z0-9]example\.(com|org)'
   description: 'example domains'
 - search: 'tmendo'
   description: 'tmendo'
   exclude: 'tmendoza'
</pre>
<p></code>
</p>
<li>run it with <code>python pystemon.py -v -c pystemon.yaml</code></li>
</ol>
<p>A few mistakes and Pastebin blocked my IP. Later they unblocked it and told me the threshold to stay safe, but in the meantime I have decided to proxy the requests through TOR. Since TOR only exposes a SOCKS proxy and Pystemon only supports HTTP proxies I used DeleGate.<br />
Pystemon was originally designed to cycle through multiple proxies removing those that fail. I needed it to stick with the TOR proxy even if it eventually failed sometimes, so I forked the project, added support for a single proxy without removals, fixed some TODOs, included a few fixes from another committer, and did a pull request.</p>
<p>2. setup <a href="http://www.delegate.org/delegate/" title="DeleGate" target="_blank">DeleGate</a> to convert an SOCKS proxy to an HTTP proxy<br />
Because TOR exposes a SOCKS proxy and Pystemon only supports HTTP proxy I am running DeleGate to pass requests between them.</p>
<ol>
<li>download the <a href="http://delegate.hpcc.jp/anonftp/DeleGate/delegate9.9.13.tar.gz" target="_blank">source</a></li>
<li><code>tar zxvf delegate9.9.13.tar.gz</code></li>
<li><code>make</code></li>
<li>create dg.conf<br />
<code></p>
<pre>
-P127.0.0.1:8080
-Tx
-fv
SOCKS=127.0.0.1:9050
DGROOT="/path/to/delegate/"
SERVER=http
REMITTABLE="http,https/443"
CACHE=no
TIMEOUT="shutout:30m"
MAXIMA="randstack:32"
MAXIMA="randenv:1024"
MAXIMA="randfd:32"
ADMIN=your.email@example.com
</pre>
<p></code></li>
<li>execute with <code>/path/to/delegated +=/path/to/delegate/dg.conf</code></li>
</ol>
<p>3. setup <a href="https://www.torproject.org/" title="TOR" target="_blank">TOR</a> following these <a href="https://www.torproject.org/docs/debian.html.en#ubuntu" title="TOR" target="_blank">instructions</a>.<br />
This will install and start the daemon with the default configuration that generates new circuits every 10 minutes (you get a new IP every 10 minutes, at least). Pastebin does not discriminate TOR exit nodes, not sure about the other paste sites.</p>
<p>Test the DeleGate and TOR combination:</p>
<p><code></p>
<pre>
telnet localhost 8080
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
GET / HTTP/1.1
host: mendo.pt

HTTP/1.1 301 Moved Permanently
DeleGate-Ver: 9.9.13 (delay=9)
Server: nginx
Date: Fri, 27 Mar 2015 14:38:04 GMT
Content-Type: text/html
Location: /
Strict-Transport-Security: max-age=31536000; includeSubDomains
Via: 1.1 - (DeleGate/9.9.13)
Connection: close
Content-Length: 178
</pre>
<p></code><br />
profit!</p>
<p>4. setup a script that parses the stored pastes and do something useful.<br />
You can use inotifywait to detect new pastes downloaded by Pystemon and do whatever you like with them (run it in a sandbox, do some further string matching, etc.)<br />
<code></p>
<pre>#!/bin/bash

is_dir_pattern=\\bISDIR\\b

inotifywait -r -m /path/to/pystemon/output -e close_write |
    while read path action file; do
        ﻿if [[ ! "$action" =~ $is_dir_pattern ]]; then
            ﻿echo "The file '$file' appeared in directory '$path' via '$action'"
	    ﻿# process $path/$file
            ﻿# notify me of some finding
        fi
    done</pre>
<p></code></p>
<blockquote><p><code><strong>EDIT</strong></code><br />
Listening to create and moved_to events might result in you being warned of a new file before its contents are written so you would end up with an empty file to process. Use close_write instead.
</p></blockquote>
<p>And thats it. Put everything under <a href="http://cr.yp.to/daemontools.html" title="Daemontools" target="_blank">DJB Daemontools</a> and you are able to monitor some paste sites for whatever you like and whatever reason.</p>
]]></content:encoded>
					
					<wfw:commentRss>/monitoring-pastebin/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Not even God forgives passwords in clear text</title>
		<link>/not-even-god-forgives-passwords-in-clear-text/</link>
					<comments>/not-even-god-forgives-passwords-in-clear-text/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Sat, 07 Mar 2015 22:23:00 +0000</pubDate>
				<category><![CDATA[passwords]]></category>
		<category><![CDATA[clear text]]></category>
		<category><![CDATA[cleartext]]></category>
		<category><![CDATA[hash]]></category>
		<category><![CDATA[owasp]]></category>
		<category><![CDATA[password]]></category>
		<category><![CDATA[pbkdf2]]></category>
		<category><![CDATA[storage]]></category>
		<guid isPermaLink="false">/?p=106</guid>

					<description><![CDATA[I think this comic from CommitStrip says it all: Passwords stored in clear text are half of the recipe to scary headlines such as &#8220;thousands of accounts published online by hackers&#8221;. To complete the recipe just add a single SQL injection or a good path traversal/LFI mix. Mature and trained developers rarely make such mistake, [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I think this comic from <a href="http://www.commitstrip.com/" title="CommitStrip">CommitStrip</a> says it all:<br />
<a href="http://www.commitstrip.com/en/2015/03/06/welcome-to-the-house-of-code/"><img decoding="async" loading="lazy" src="/wp-content/uploads/2015/03/Strip-Confession-650-finalenglish.jpg" alt="CommitStrip clear text passwords" width="650" height="899" class="size-full wp-image-130" /></a></p>
<p>Passwords stored in clear text are half of the recipe to scary headlines such as &#8220;thousands of accounts published online by hackers&#8221;. To complete the recipe just add a single SQL injection or a good path traversal/LFI mix.</p>
<p>Mature and trained developers rarely make such mistake, why? Because they had training and understand the consequences. The problem is the others, which need to be self-taught.</p>
<p>So let me be very clear:</p>
<ul>
<li>you don&#8217;t need passwords in clear text to compare against the ones from login</li>
<li>you can compare representations of them, lets say an hash</li>
<li>never store or log passwords</li>
</ul>
<p>Regarding the storing itself, there are way too many options [1]. I will recommend just one, which is adequate for most situations (if you feel this does not fits you, please contact the nearest security guy, or leave a comment):</p>
<p><code>function store(password)<br />
&nbsp;&nbsp;&nbsp;&nbsp;salt = secureRandom(32bits)<br />
&nbsp;&nbsp;&nbsp;&nbsp;hash = pbkdf2(salt, password, 10000)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;storeAtDB(salt;hash)<br />
end</p>
<p>function validate(user, password)<br />
&nbsp;&nbsp;&nbsp;&nbsp;salt,hash = getUserFromDB(user).split(;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;login_hash = pbkdf2(salt, password, 10000)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;if (login_hash XOR hash == 0 )<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true<br />
&nbsp;&nbsp;&nbsp;&nbsp;else<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false<br />
end</p>
<p></code></p>
<p>I won&#8217;t explain these in detail, but the basic idea is to store an hash of the password plus a salt. No, it is not easy to find out the password given an hash + salt. No, it won&#8217;t slow down your application. Yes, you will be much, much safer.</p>
<p>[1] <a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" title="OWASP Password Storage Cheat Sheet" target="_blank">https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet</a></p>
]]></content:encoded>
					
					<wfw:commentRss>/not-even-god-forgives-passwords-in-clear-text/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>B-Sides Lisbon is coming</title>
		<link>/b-sides-lisbon-is-coming/</link>
					<comments>/b-sides-lisbon-is-coming/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Thu, 29 Jan 2015 22:23:03 +0000</pubDate>
				<category><![CDATA[conference]]></category>
		<category><![CDATA[b-sides]]></category>
		<category><![CDATA[burp]]></category>
		<category><![CDATA[lisbon]]></category>
		<guid isPermaLink="false">/?p=83</guid>

					<description><![CDATA[The second edition of B-Sides Lisbon is coming! This security conference is happening at the 3rd of July in Lisbon and its a whole day event with two tracks of talks and some good discussions. And it is free! The previous, and first edition, happened in 2013 and it was awesome. You can revisit the [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>The second edition of B-Sides Lisbon is coming! This security conference is happening at the 3rd of July in Lisbon and its a whole day event with two tracks of talks and some good discussions. And it is free!</p>
<p><a href="/wp-content/uploads/2015/01/Screen-Shot-2015-01-29-at-21.39.40.png"><img decoding="async" loading="lazy" src="/wp-content/uploads/2015/01/Screen-Shot-2015-01-29-at-21.39.40.png" alt="Screen Shot 2015-01-29 at 21.39.40" width="286" height="239" class="alignnone size-full wp-image-87" /></a></p>
<p>The previous, and first edition, happened in 2013 and it was awesome. You can revisit the program <a href="https://web.archive.org/web/20131007130544/http://www.bsideslisbon.org/?page_id=86" title="B-Sides Lisbon 2013 schedule archive" target="_blank">here</a> and search for the talks on Google (you will find some for sure).<br />
With a quick search I found Bruno Morisson&#8217;s preso:</p>
<p><iframe loading="lazy" src="//www.slideshare.net/slideshow/embed_code/24105478" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; max-width: 100%;" allowfullscreen> </iframe><br />
btw, he is also one of the organizers :)</p>
<p>I also did a presentation on how to start using Burp Suite, including a few tips to use it more efficiently:</p>
<p><iframe loading="lazy" src="//www.slideshare.net/slideshow/embed_code/26915928" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe></p>
<p>Now that you know this years edition will be even better, go ahead and submit a talk <a href="http://www.bsideslisbon.org/call-for-papers/" title="B-Sides Lisbon 2015 call for papers" target="_blank">here</a></p>
]]></content:encoded>
					
					<wfw:commentRss>/b-sides-lisbon-is-coming/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Hardening WordPress</title>
		<link>/hardening-wordpress/</link>
					<comments>/hardening-wordpress/#respond</comments>
		
		<dc:creator><![CDATA[tmendo]]></dc:creator>
		<pubDate>Sat, 03 Jan 2015 18:56:19 +0000</pubDate>
				<category><![CDATA[hardening]]></category>
		<category><![CDATA[web security]]></category>
		<category><![CDATA[wordpress]]></category>
		<guid isPermaLink="false">/?p=27</guid>

					<description><![CDATA[I think it makes sense that the very first post on my brand new WordPress blog would be about hardening WordPress itself. This makes even more sense if you consider it took me more time to harden this blog than to write this post. For the installation just follow the official documentation found here to [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I think it makes sense that the very first post on my brand new WordPress blog would be about hardening WordPress itself. This makes even more sense if you consider it took me more time to harden this blog than to write this post.</p>
<p>For the installation just follow the official documentation found <a href="http://codex.wordpress.org/Installing_WordPress">here</a> to which I just want to make one remark about the database password strength: </p>
<p><code>GRANT ALL PRIVILEGES ON databasename.* TO "wordpressusername"@"hostname" IDENTIFIED BY "password";</code></p>
<p>Use a long password here, something like ﻿sK8ytB8mR5PtxqqTmCEYThEUJS5J6D which is 30 chars long. You won&#8217;t need to type this password often so there is no need to use a memorable one.<br />
To be honest, a weak password here wouldn&#8217;t be that bad since it is unlikely that you server will fall because of this&#8230;unless you expose it beyond 127.0.0.1.</p>
<p>For the hardening, start <a href="http://codex.wordpress.org/Hardening_WordPress">here</a>. There is some smalltalk but there are also some good advices regarding a few topics:    </p>
<ul>
<li>updates</li>
<li>file permissions</li>
<li>wp-admin</li>
<li>wp-includes</li>
<li>security plugins</li>
</ul>
<p><strong>updates</strong><br />
Keeping your installation up to date is paramount to ensure proper security. Before version 3.7 updates really sucked because the easiest way to (automatically) update was to have all files writable by the webserver process, so basically any malicious code executed by the webserver would be able to overwrite any file from our installation. The alternative was more secure but harder, so people wouldn&#8217;t update.<br />
In the latest versions there is some magic that let you have automatic updates without the need to have files writable by the webserver. I think there is more than one way to achieve this: I went for the SSH one.<br />
I followed this <a href="https://www.digitalocean.com/community/tutorials/how-to-configure-secure-updates-and-installations-in-wordpress-on-ubuntu">tutorial</a>. In addition to the 5 defines added to the wp-config.php file, I also added <code>define('FS_METHOD', 'ssh2');</code>.<br />
Since we are adding a new SSH user and we don&#8217;t want to increase your attack surface, disable password authentication for SSH at /etc/ssh/sshd_config with <code>PasswordAuthentication no</code>. Well&#8230;you should always disable password authentication for SSH. </p>
<p><strong>file permissions</strong><br />
The important thing here is to prevent the webserver from writing files. There are some exceptions, as you might want to allow functionality such as image upload (so I can haz pretty potatoes pic).<br />
You can have all files with owner and group wp-user, everything with 644 (files) or 755 (diretories).<br />
The exception is wp-content/uploads that must be writable by the group (775) and have the group www-data set. You don&#8217;t need to allow webserver writing for the others since updates and installations are done through SSH and run with wp-user.</p>
<p><strong>wp-admin</strong><br />
/wp-admin is a prime target for attackers because that is where you login to administrate your blog with your admin username and your weak password :)<br />
Leaving /wp-admin world accessible exposes you to two problems: credential bruteforce/reuse/theft and direct access to files that may have all sort of vulnerabilities.<br />
The most practical way to protect you from these is require some sort of authentication, say basic authentication. With nginx you just need to add this to your virtual host<br />
<code><br />
        location = /wp-admin {<br />
                auth_basic "Restricted";<br />
                auth_basic_user_file /path/to/your/htpasswd;<br />
        }</code></p>
<p>and define the username and password. Please use a strong password here and also for your /wp-admin accounts.</p>
<blockquote><p><code><strong>EDIT</strong></code><br />
Also protect the /wp-login.php since it is used to login to edit the blog.<br />
I include the snippet below to demonstrate the care you must take with nginx locations while configuring the rules described in this blog. Without going into details, prefix matching has precedence over regexp matching and nested locations with regex must have only regex inside.<br />
<code> location = /wp-admin {<br />
                auth_basic "Restricted";<br />
                auth_basic_user_file /etc/nginx/htpasswd;<br />
        }</p>
<p>        location ~ \.php$ {<br />
                location ~* /wp-login.php {<br />
                        auth_basic "Restricted login";<br />
                        auth_basic_user_file /etc/nginx/htpasswd;<br />
                }</p>
<p>                location ~* wp-config.php {<br />
                        deny all;<br />
                }<br />
</code></p></blockquote>
<p><strong>security plugins</strong><br />
Having many plugins installed is asking for trouble since many have vulnerabilities and don&#8217;t even get fixed. So, going against the usual recommendation of not installing plugins, install the Sucuri Security &#8211; Auditing, Malware Scanner and Hardening plugin.<br />
After installing, you get a Sucuri Security button on your dashboard side menu that lets you access the plugin dashboard<br />
<a href="/wp-content/uploads/2015/01/Screen-Shot-2015-01-03-at-17.48.34.png"><img decoding="async" loading="lazy" src="/wp-content/uploads/2015/01/Screen-Shot-2015-01-03-at-17.48.34.png" alt="Sucuri Security menu" width="880" height="238" class="alignnone size-full wp-image-55" /></a></p>
<p>Some of the features are paid, but you get a few nice things for free. In the hardening tab you can verify if have the proper secure configurations, however some only work if you are using Apache. More specifically, &#8220;Protect uploads directory&#8221;, &#8220;Restrict wp-content access&#8221; and &#8220;Restrict wp-includes access&#8221; will remain red under nginx even if properly configured, because the plugin expects Apache specific configuration.<br />
In the Settings tab you have another interesting feature: the scanner. The plugin can scan your wordpress installation for changes and notify you by email, like an HIDS. Go through the Settings tabs and activate/deactivate options as you please.</p>
<p>Additionally to the 5 previous topics, I recommend following this extra 2:</p>
<p><strong>Delete themes</strong><br />
Regarding themes&#8230;you just use one so delete those you don&#8217;t use, as well as the pre-installed useless plugin <a href="https://wordpress.org/plugins/hello-dolly/">Hello Dolly</a>.</p>
<p><strong>Limit PHP execution</strong><br />
Direct access to PHP files laying around in your installation are known to cause problem, so disable PHP execution wherever you can. If using nginx add the configuration below to your virtual host. For Apache just use the Sucuri plugin or use Google.</p>
<p>       <code> location ~* wp-config.php {<br />
                deny all;<br />
        }</p>
<p>        location ~* wp-content/(.*)\.php$ {<br />
                deny all;<br />
        }</p>
<p>        location ~* wp-includes/(.*)\.php$ {<br />
                deny all;<br />
        }</p>
<p>        location ~* wp-includes/uploads/sucuri$ {<br />
                deny all;<br />
        }</code></p>
<p>And finally&#8230;<strong>HTTPS</strong><br />
I don&#8217; need extra motivation to make my blog available only by HTTPS but you if you are thinking twice, just remember Google favors HTTPS sites in the search results and you can get certificates for free from <a href="https://www.startssl.com/">StartSSL</a>, for instance.<br />
Configuring HTTPS for WordPress is just like doing it for any another virtual host. Just remember a few things:</p>
<ul>
<li>change your site from http://example.com/ to http<strong>s</strong>://example.com at Settings->General->WordPress Address and Site Address</li>
<li>force a 301 redirect from HTTP to HTTPS</li>
<li>send a HSTS header to ensure you are always under HTTPS</li>
<li>disable all SSL versions and enable only TLS</li>
<li>enable strong ciphers such as <code>ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-RC4-SHA:RC4:HIGH:!MD5:!aNULL:!EDH</code></li>
<li>enable server cipher preference</li>
</ul>
<p>Then, go to <a href="https://www.ssllabs.com/ssltest/">SSL Labs</a> and test your configuration.</p>
<p>If you are paranoid, you can continue hardening your WordPress, webserver, PHP, and OS forever, but you have to balance that against the time you have available.</p>
<p>So..I guess I have an WordPress blog. Lets see how long it holds without being hacked&#8230;</p>
]]></content:encoded>
					
					<wfw:commentRss>/hardening-wordpress/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
	</channel>
</rss>
